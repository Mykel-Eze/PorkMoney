!function(t){"use strict";var r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],n=Modernizr.csstransitions;function s(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t}function e(t,e){this.el=t,this.options=s({},this.options),s(this.options,e),this._init()}e.prototype.options={onSubmit:function(){return!1}},e.prototype._init=function(){this.current=0,this.questions=[].slice.call(this.el.querySelectorAll("ol.questions > li")),this.questionsCount=this.questions.length,classie.addClass(this.questions[0],"current"),this.ctrlNext=this.el.querySelector("button.next"),this.ctrlPrev=this.el.querySelector("button.prev"),this.progress=this.el.querySelector("div.progress"),this.questionStatus=this.el.querySelector("span.number"),this.currentNum=this.questionStatus.querySelector("span.number-current"),this.currentNum.innerHTML=Number(this.current+1),this.totalQuestionNum=this.questionStatus.querySelector("span.number-total"),this.totalQuestionNum.innerHTML=this.questionsCount,this.error=this.el.querySelector("span.error-message"),this._initEvents()},e.prototype._initEvents=function(){var e=this,t=this.questions[this.current].querySelector("input"),s=function(){t.removeEventListener("focus",s),classie.addClass(e.ctrlNext,"show"),classie.addClass(e.ctrlPrev,"show"),classie.addClass(e.ctrl,"show")};t.addEventListener("focus",s),this.ctrlNext.addEventListener("click",function(t){t.preventDefault(),e._nextQuestion()}),$(this.ctrlPrev).click(function(t){t.preventDefault(),e._prevQuestion()}),document.addEventListener("keydown",function(t){13===(t.keyCode||t.which)&&(t.preventDefault(),e._nextQuestion())}),this.el.addEventListener("keydown",function(t){9===(t.keyCode||t.which)&&t.preventDefault()})},e.prototype._nextQuestion=function(){if(!this._validade())return!1;this.current===this.questionsCount-1&&(this.isFilled=!0),this._clearError();var t=this.questions[this.current];if(++this.current,this._progress(),!this.isFilled){this._updateQuestionNumber(),classie.addClass(this.el,"show-next");var e=this.questions[this.current];classie.removeClass(t,"current"),classie.addClass(e,"current")}var s=this,i=function(t){n&&this.removeEventListener(r,i),s.isFilled?s._submit():(classie.removeClass(s.el,"show-next"),s.currentNum.innerHTML=Number(s.newQuestionNum),e.querySelector("input").focus())};n?this.progress.addEventListener(r,i):i()},e.prototype._prevQuestion=function(){this._clearError();var t=this.questions[this.current];--this.current,this.current<0&&(this.current=0),this._progress(),this._updateQuestionNumber(),classie.addClass(this.el,"show-next");var e=this.questions[this.current];classie.removeClass(t,"current"),classie.addClass(e,"current");var s=this,i=function(t){n?(classie.removeClass(s.el,"show-next"),s.currentNum.innerHTML=Number(s.newQuestionNum),e.querySelector("input").focus()):this.removeEventListener(r,i)};n?(this.progress.addEventListener(r,i),classie.removeClass(s.el,"show-next")):i()},e.prototype._progress=function(){this.progress.style.width=this.current*(100/this.questionsCount)+"%"},e.prototype._updateQuestionNumber=function(){this.newQuestionNum=Number(this.current+1)},e.prototype._submit=function(){this.options.onSubmit(this.el)},e.prototype._validade=function(){var t=this.questions[this.current].querySelector("input");if(t.hasAttribute("data-validate"))switch(t.getAttribute("data-validate")){case"none":break;case"email":if(!this._validateEmail(t.value))return this._showError("INVALIDEMAIL"),!1;break;case"checkbox":if(!this._validateCheckbox(t))return this._showError("INVALIDCHECKBOX"),!1}else if(""===t.value)return this._showError("EMPTYSTR"),!1;return!0},e.prototype._validateEmail=function(t){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(t)},e.prototype._validateCheckbox=function(t){return $(t).prop("checked")},e.prototype._showError=function(t){var e="";switch(t){case"EMPTYSTR":e="Please fill the field before continuing";break;case"INVALIDEMAIL":e="Please fill a valid email address"}this.error.innerHTML=e,classie.addClass(this.error,"show")},e.prototype._clearError=function(){classie.removeClass(this.error,"show")},t.stepsForm=e}(window);